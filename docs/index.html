<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Caleb Drew · Live Intelligence Hub</title>
  <meta name="description" content="Interactive data portfolio blending real-time intelligence, predictive analytics, and clear storytelling." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    :root{
      --bg: #0b1220;
      --card:#0f172a;
      --card-2:#111827;
      --fg:#e5e7eb;
      --muted:#9ca3af;
      --brand:#7c3aed;
      --brand-2:#06b6d4;
      --ok:#22c55e; --warn:#f59e0b; --err:#ef4444;
      --ring: 0 0 0 2px rgba(124,58,237,.45), 0 0 0 6px rgba(6,182,212,.15);
    }
    [data-theme="light"]{--bg:#f8fafc;--card:#ffffff;--card-2:#f1f5f9;--fg:#0f172a;--muted:#475569}
    html,body{height:100%;}
    body{margin:0;background:radial-gradient(1200px 800px at 20% -10%, rgba(124,58,237,.20), transparent),
                 radial-gradient(900px 600px at 90% 10%, rgba(6,182,212,.18), transparent), var(--bg);
         color:var(--fg);font:16px/1.6 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
    a{color:var(--brand)}
    .page{display:grid;grid-template-columns: 270px 1fr;gap:20px;max-width:1400px;margin:0 auto;padding:20px}
    .rail{position:sticky;top:16px;height:calc(100dvh - 32px);background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;backdrop-filter: blur(8px)}
    .brand{font-weight:800;letter-spacing:.3px;background:linear-gradient(90deg,var(--brand),var(--brand-2));-webkit-background-clip:text;background-clip:text;color:transparent;font-size:20px;margin-bottom:10px}
    .rail nav{display:flex;flex-direction:column;gap:6px;margin-top:8px}
    .rail a{padding:8px 10px;border-radius:10px;color:var(--muted);text-decoration:none}
    .rail a.active,.rail a:hover{color:var(--fg);background:rgba(124,58,237,.15)}
    .rail .footer{margin-top:auto;font-size:12px;color:var(--muted)}

    .panel{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:20px;margin-bottom:20px}
    .panel-header h2{margin:0 0 6px;font-size:22px}
    .panel-header p{margin:0;color:var(--muted)}

    .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:20px;align-items:center}
    .gradient-text{background:linear-gradient(90deg,#fff, #c4b5fd, #67e8f9);-webkit-background-clip:text;background-clip:text;color:transparent}
    .kicker{color:var(--muted);font-weight:600;letter-spacing:.2em;text-transform:uppercase}
    h1{font-size:36px;line-height:1.2;margin:6px 0 10px}
    .hero .actions{display:flex;gap:10px;margin-top:10px}
    .btn{border:1px solid rgba(255,255,255,.18);background:rgba(124,58,237,.15);color:#fff;padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer}
    .btn:hover{box-shadow:var(--ring)}
    .btn.ghost{background:transparent;color:var(--fg)}
    .btn.primary{background:linear-gradient(90deg,var(--brand),var(--brand-2));border:0}
    .btn.full{width:100%}
    .statbar{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:14px}
    .stat{background:var(--card-2);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px}
    .stat .label{font-size:12px;color:var(--muted)}
    .stat .value{font-size:22px;font-weight:800}
    canvas{width:100%;height:260px}

    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}

    .skill-matrix{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .chip{display:inline-flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,.14);padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.04);font-size:12px;color:var(--muted)}
    .bar{height:10px;background:rgba(255,255,255,.08);border-radius:999px;overflow:hidden}
    .bar > span{display:block;height:100%;background:linear-gradient(90deg,var(--brand),var(--brand-2))}

    .card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:14px}
    .card h3{margin:4px 0 10px}
    .badge{font-size:11px;border:1px solid rgba(255,255,255,.18);padding:2px 6px;border-radius:999px;color:var(--muted)}
    #housing-map{height:300px;border-radius:12px;overflow:hidden}
    .code-block{background:#0b1020;border-radius:10px;padding:12px;overflow:auto;white-space:pre}
    .pipeline-status{display:grid;gap:8px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}

    .timeline{display:grid;gap:12px}
    .event{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px}
    .event .meta{color:var(--muted);font-size:12px}

    .topbar{position:fixed;right:24px;top:20px;display:flex;gap:8px;z-index:4}
    .topbar .toggle{background:var(--card);border:1px solid rgba(255,255,255,.18);border-radius:10px;padding:8px 10px;cursor:pointer}

    @media (max-width: 980px){
      .page{grid-template-columns: 1fr}
      .rail{position:static;height:auto}
      .hero{grid-template-columns:1fr}
      .skill-matrix{grid-template-columns:1fr}
      .grid-3{grid-template-columns:1fr}
      .grid-2{grid-template-columns:1fr}
    }

    @media print{ .rail,.topbar{display:none} body{background:#fff;color:#000} .panel{border:0} a{text-decoration:none;color:inherit} }
  </style>
</head>
<body>
  <div class="topbar">
    <button id="themeToggle" class="toggle" title="Toggle theme">Theme</button>
    <a class="toggle" href="#contact" onclick="document.getElementById('contactLink').click()">Contact</a>
  </div>

  <div class="page">
    <!-- NAV RAIL -->
    <aside class="rail" aria-label="Section navigation">
      <div class="brand">Live Intelligence Hub</div>
      <nav id="railNav">
        <a href="#about">About</a>
        <a href="#skills">Skills</a>
        <a href="#open-source">Open Source</a>
        <a href="#business-ops">Business Ops</a>
        <a href="#revenue-forecast">Revenue Forecast</a>
        <a href="#macro-forecast">Economic Outlook</a>
        <a href="#live-dashboards">Live Dashboards</a>
        <a href="#data-engineering">Data Engineering</a>
        <a href="#resume">Dynamic Resume</a>
      </nav>
      <div class="footer">© <span id="year"></span> Caleb Drew</div>
    </aside>

    <!-- MAIN -->
    <main>
      <!-- HERO -->
      <section id="about" class="panel hero">
        <div>
          <div class="kicker">Hello, I'm</div>
          <h1><span class="gradient-text">Caleb Drew</span></h1>
          <p id="heroTag">Building data products that combine real‑time intelligence, predictive analytics, and unapologetically clean storytelling.</p>
          <div class="actions">
            <button id="dlResume" class="btn primary">Download Resume</button>
            <a id="contactLink" class="btn ghost" href="mailto:calebldrew@gmail.com?subject=Let’s collaborate">Let's Collaborate</a>
          </div>
          <div class="statbar">
            <div class="stat"><div class="label">Years of Experience</div><div class="value" id="statYears">0</div></div>
            <div class="stat"><div class="label">Projects Delivered</div><div class="value" id="statProjects">0</div></div>
            <div class="stat"><div class="label">Industries Impacted</div><div class="value" id="statIndustries">0</div></div>
          </div>
        </div>
        <div>
          <canvas id="signatureChart" aria-hidden="true"></canvas>
        </div>
      </section>

      <!-- SKILLS -->
      <section id="skills" class="panel">
        <div class="panel-header">
          <h2>Full‑Stack Data Skillset</h2>
          <p>A cross‑functional blend of analytics, engineering, visualization, and leadership powering business growth.</p>
        </div>
        <div class="skill-matrix" id="skillMatrix"></div>
      </section>

      <!-- OPEN SOURCE -->
      <section id="open-source" class="panel">
        <div class="panel-header">
          <h2>Open Source Intelligence</h2>
          <p>Auto‑pulling a snapshot of public GitHub footprint (unauthenticated, rate‑limited).</p>
        </div>
        <div class="grid-2">
          <div class="card">
            <h3>Language Mix</h3>
            <canvas id="langChart"></canvas>
          </div>
          <div class="card">
            <h3>Recent Stars</h3>
            <ul id="repoList"></ul>
          </div>
        </div>
      </section>

      <!-- BUSINESS OPS -->
      <section id="business-ops" class="panel">
        <div class="panel-header">
          <h2>Business Operations Pulse</h2>
          <p>Simulated mutual fund flow data with anomaly detection and live updates.</p>
        </div>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h3>Capital Flow Trends</h3><span class="badge">Live</span>
          </div>
          <canvas id="flowChart"></canvas>
          <div id="flowInsight" class="chip" style="margin-top:8px">Initializing…</div>
        </div>
      </section>

      <!-- REVENUE FORECAST -->
      <section id="revenue-forecast" class="panel">
        <div class="panel-header">
          <h2>Public Company Revenue Scenario Lab</h2>
          <p>Lightweight scenario generator. Not investment advice—this is a toy model.</p>
        </div>
        <div class="grid-2">
          <div class="card"><h3 id="revTitle">Company Forecast</h3><canvas id="revChart"></canvas></div>
          <div class="card">
            <h3>Scenario Controls</h3>
            <div class="grid-2">
              <label>Company Symbol<br><input id="sym" type="text" value="MSFT" maxlength="5" style="width:100%"></label>
              <label>Horizon (months)<br><input id="horizon" type="number" min="3" max="18" value="9" style="width:100%"></label>
              <label>Growth Optimism<br><input id="optimism" type="range" min="0" max="1" step="0.1" value="0.5" style="width:100%"></label>
              <label>Volatility<br><input id="vol" type="range" min="0" max="1" step="0.1" value="0.3" style="width:100%"></label>
            </div>
            <button id="runRev" class="btn primary full" style="margin-top:10px">Recompute Forecast</button>
            <div id="revInsight" class="chip" style="margin-top:10px">—</div>
          </div>
        </div>
      </section>

      <!-- MACRO -->
      <section id="macro-forecast" class="panel">
        <div class="panel-header">
          <h2>U.S. Macro Foresight</h2>
          <p>Unsold housing “hotspots” + macro indicator outlook (toy data).</p>
        </div>
        <div class="grid-2">
          <div class="card"><div style="display:flex;justify-content:space-between;align-items:center"><h3>Unsold Housing Hotspots</h3><span class="badge">Live</span></div><div id="housing-map"></div></div>
          <div class="card"><h3>Macro Indicator Outlook</h3><canvas id="macroChart"></canvas><div id="macroInsight" class="chip" style="margin-top:10px">—</div></div>
        </div>
      </section>

      <!-- LIVE DASHBOARDS -->
      <section id="live-dashboards" class="panel">
        <div class="panel-header">
          <h2>Streaming Intelligence Deck</h2>
          <p>Continuously updating signals (toy data with random walk).</p>
        </div>
        <div class="grid-3">
          <div class="card"><h3>U.S. Trend Tracker</h3><canvas id="usTrend"></canvas></div>
          <div class="card"><h3>Market Volatility Watch</h3><canvas id="volChart"></canvas></div>
          <div class="card"><h3>Signals</h3><ul id="signalList"></ul></div>
        </div>
      </section>

      <!-- DATA ENGINEERING -->
      <section id="data-engineering" class="panel">
        <div class="panel-header">
          <h2>Data Engineering Fabric</h2>
          <p>Lightweight ETL orchestration powering dashboards with resilient contracts.</p>
        </div>
        <div class="grid-2">
          <div class="card"><h3>Pipeline Blueprint</h3><pre id="etl" class="code-block"></pre></div>
          <div class="card"><h3>Latest Pipeline Run</h3><div id="pipe" class="pipeline-status"></div><button id="runPipe" class="btn ghost full" style="margin-top:8px">Trigger Demo Pipeline</button></div>
        </div>
      </section>

      <!-- RESUME -->
      <section id="resume" class="panel">
        <div class="panel-header">
          <h2>Dynamic Resume Narrative</h2>
          <p>Filter milestones by theme. Every bullet earns its oxygen with a number.</p>
        </div>
        <div class="grid-2">
          <div class="card">
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn ghost chip" data-filter="all">All</button>
              <button class="btn ghost chip" data-filter="leadership">Leadership</button>
              <button class="btn ghost chip" data-filter="data-science">Data Science</button>
              <button class="btn ghost chip" data-filter="engineering">Engineering</button>
            </div>
          </div>
          <div class="card"><div id="timeline" class="timeline"></div></div>
        </div>
      </section>
    </main>
  </div>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js" integrity="sha384-pBiVmIy/H/vPgZuoPKyMLkJLc60brB20/wlqO23gmO35v7bT41SEuz7rtN2+UwbA" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

  <script type="module">
    // ===== Utilities =====
    const $ = (s, d=document) => d.querySelector(s);
    const $$ = (s, d=document) => [...d.querySelectorAll(s)];
    const clamp = (x,a,b)=>Math.max(a,Math.min(b,x));
    const fmt = n => Intl.NumberFormat().format(n);

    // ===== Theme toggle =====
    const themeToggle = $('#themeToggle');
    const saved = localStorage.getItem('theme');
    if(saved){ document.documentElement.setAttribute('data-theme', saved); }
    themeToggle.addEventListener('click',()=>{
      const cur = document.documentElement.getAttribute('data-theme');
      const next = cur === 'light' ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
    });

    // Footer year
    $('#year').textContent = new Date().getFullYear();

    // ===== Scrollspy =====
    const navLinks = $$('#railNav a');
    const sections = navLinks.map(a => $(a.getAttribute('href'))).filter(Boolean);
    const spy = new IntersectionObserver(entries => {
      entries.forEach(e => {
        if(e.isIntersecting){
          navLinks.forEach(a=>a.classList.toggle('active', a.getAttribute('href') === '#' + e.target.id));
        }
      });
    }, {rootMargin:'-40% 0px -55%'});
    sections.forEach(s=>spy.observe(s));

    // ===== Stats counters =====
    const counters = [
      {el: '#statYears', to: 5},
      {el: '#statProjects', to: 42},
      {el: '#statIndustries', to: 6},
    ];
    counters.forEach(({el,to})=>{
      const node = $(el); let cur=0; const step = Math.ceil(to/40);
      const id = setInterval(()=>{cur+=step; if(cur>=to){cur=to;clearInterval(id)} node.textContent=fmt(cur);}, 30);
    });

    // ===== Hero signature chart =====
    const sigCtx = $('#signatureChart');
    const sig = new Chart(sigCtx, {
      type:'line',
      data:{labels:[...Array(40).keys()], datasets:[{label:'signal', tension:.35, fill:true,
        data:[...Array(40)].map((_,i)=> 10+Math.sin(i/2)*6 + (Math.random()*2-1)),
        borderColor:'rgba(124,58,237,1)', backgroundColor:'rgba(124,58,237,.18)'}]},
      options:{plugins:{legend:{display:false}}, scales:{x:{display:false}, y:{display:false}}, elements:{point:{radius:0}}, animation:{duration:1200}}
    });

    // ===== Skills =====
    const skills = [
      {name:'Python', lvl:95}, {name:'SQL', lvl:90}, {name:'Power BI', lvl:88},
      {name:'Pandas', lvl:90}, {name:'DAX', lvl:80}, {name:'ETL/Orchestration', lvl:82},
      {name:'Forecasting', lvl:84}, {name:'Experimentation', lvl:78}, {name:'Visualization', lvl:92},
      {name:'Leadership', lvl:85}, {name:'Pricing/Inventory', lvl:86}, {name:'Ops Analytics', lvl:88},
    ];
    const sm = $('#skillMatrix');
    skills.forEach(s=>{
      const wrap = document.createElement('div');
      wrap.innerHTML = `<div style="display:flex;justify-content:space-between"><span class="chip">${s.name}</span><span class="chip">${s.lvl}%</span></div><div class="bar"><span style="width:${s.lvl}%"></span></div>`;
      sm.appendChild(wrap);
    });

    // ===== GitHub (public, rate limited) =====
    const GH_USER = 'calebldrew'; // change if needed
    const repoList = $('#repoList');
    fetch(`https://api.github.com/users/${GH_USER}/starred?per_page=5`)
      .then(r=>r.json()).then(rows=>{
        (rows || []).forEach(r=>{
          const li=document.createElement('li');
          li.innerHTML = `<a href="${r.html_url}" target="_blank">${r.full_name}</a> — ★${r.stargazers_count} · ${r.language || '—'}`;
          repoList.appendChild(li);
        });
        if(!rows?.length){ repoList.innerHTML = '<li class="chip">No recent stars found.</li>'; }
      }).catch(()=> repoList.innerHTML = '<li class="chip">GitHub API limit. Try later.</li>');

    // Fake language mix
    const lang = new Chart($('#langChart'), {
      type:'doughnut',
      data:{labels:['Python','TypeScript','SQL','R','Other'], datasets:[{data:[48,22,18,6,6]}]},
      options:{plugins:{legend:{position:'bottom'}}, cutout:'65%'}
    });

    // ===== Business Ops (live random walk) =====
    const flowData = Array.from({length:40},(_,i)=>({x:i, y: 100 + (Math.random()*10)}));
    const flow = new Chart($('#flowChart'), {
      type:'line', data:{datasets:[{data:flowData, borderColor:'rgba(6,182,212,1)', backgroundColor:'rgba(6,182,212,.15)', tension:.35, fill:true, pointRadius:0}]},
      options:{animation:false, plugins:{legend:{display:false}}, scales:{x:{display:false}, y:{grid:{color:'rgba(255,255,255,.08)'}}}}
    });
    const flowInsight = $('#flowInsight');
    setInterval(()=>{
      const last = flowData.at(-1).y;
      const next = clamp(last + (Math.random()*4-2), 90, 130);
      flowData.push({x:flowData.length, y:next}); flowData.shift(); flow.update();
      if(next-last > 1.8){ flowInsight.textContent = 'Inflow spike detected (+' + (next-last).toFixed(2) + ')'; flowInsight.style.borderColor='rgba(34,197,94,.6)'; }
      else if(last-next > 1.8){ flowInsight.textContent = 'Outflow spike (−' + (last-next).toFixed(2) + ')'; flowInsight.style.borderColor='rgba(239,68,68,.6)'; }
      else { flowInsight.textContent = 'Stable regime'; flowInsight.style.borderColor='rgba(148,163,184,.3)'; }
    }, 1200);

    // ===== Revenue Forecast (toy) =====
    const revCtx = $('#revChart'); let revChart;
    function recompute(){
      const sym = $('#sym').value.toUpperCase().slice(0,5) || 'TICK';
      const H = clamp(parseInt($('#horizon').value||9,10),3,18);
      const opt = parseFloat($('#optimism').value||0.5);
      const vol = parseFloat($('#vol').value||0.3);
      $('#revTitle').textContent = sym + ' Forecast';
      const base = Array.from({length:18},(_,i)=> 100 + i* (1+opt) + (Math.random()*6-3));
      const hist = base.slice(0,9);
      let last = hist.at(-1);
      const forecast = [];
      for(let i=0;i<H;i++){
        const drift = (0.8*opt + 0.1) * (1 + Math.sin(i/3)*0.05);
        last = last * (1 + drift/100) + (Math.random()*2-1)*vol*2;
        forecast.push(last);
      }
      const labels=[...hist.map((_,i)=>'T-'+(hist.length-i)), ...forecast.map((_,i)=>'T+'+(i+1))];
      const data=[...hist, ...forecast];
      revChart?.destroy();
      revChart = new Chart(revCtx, {type:'line', data:{labels, datasets:[
        {label:'Revenue (toy)', data, borderColor:'rgba(124,58,237,1)', backgroundColor:'rgba(124,58,237,.15)', tension:.35, fill:true, pointRadius:0}
      ]}, options:{plugins:{legend:{display:false}}, scales:{y:{grid:{color:'rgba(255,255,255,.08)'}}}}});
      const cagr = ((forecast.at(-1)/hist[0])**(12/(hist.length+H)) - 1) * 100;
      $('#revInsight').textContent = `Toy CAGR est: ${cagr.toFixed(1)}% with optimism ${opt} and vol ${vol}`;
    }
    $('#runRev').addEventListener('click', recompute);
    recompute();

    // ===== Macro (Leaflet + chart) =====
    const map = L.map('housing-map', {zoomControl:false}).setView([39.5,-98.35], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom:19, attribution:'© OSM'}).addTo(map);
    const cities = [
      {n:'Phoenix, AZ', c:[33.44,-112.07], v: 1.3},
      {n:'Austin, TX', c:[30.27,-97.74], v: 1.1},
      {n:'Tampa, FL', c:[27.95,-82.46], v: 1.2},
      {n:'Boise, ID', c:[43.62,-116.2], v: 1.4},
      {n:'Raleigh, NC', c:[35.78,-78.64], v: 1.15},
    ];
    cities.forEach(({n,c,v})=> L.circleMarker(c,{radius:10*v,color:'#7c3aed'}).addTo(map).bindPopup(`${n}<br>Unsold ×${v}`));

    const macro = new Chart($('#macroChart'), {type:'bar', data:{labels:['CPI','PCE','GDP','PMI','Unemp'], datasets:[{label:'Now', data:[3.2, 2.7, 2.1, 51, 4.2]}, {label:'Q+1', data:[3.0, 2.5, 2.3, 52, 4.1]}]}, options:{plugins:{legend:{position:'bottom'}}, scales:{y:{grid:{color:'rgba(255,255,255,.08)'}}}});
    $('#macroInsight').textContent = 'Baseline: mild disinflation, soft‑landing risk still not zero.';

    // ===== Live dashboards =====
    function makeWalk(len=40, start=50){ const out=[start]; for(let i=1;i<len;i++){ out.push(out[i-1] + (Math.random()*2-1)); } return out; }
    const usT = new Chart($('#usTrend'), {type:'line', data:{labels:[...Array(40).keys()], datasets:[{data:makeWalk(40,60), tension:.35, borderColor:'rgba(99,102,241,1)', backgroundColor:'rgba(99,102,241,.15)', fill:true, pointRadius:0}]}, options:{plugins:{legend:{display:false}}, scales:{x:{display:false}, y:{grid:{color:'rgba(255,255,255,.08)'}}}});
    const volC = new Chart($('#volChart'), {type:'line', data:{labels:[...Array(40).keys()], datasets:[{data:makeWalk(40,20), tension:.35, borderColor:'rgba(234,179,8,1)', backgroundColor:'rgba(234,179,8,.15)', fill:true, pointRadius:0}]}, options:{plugins:{legend:{display:false}}, scales:{x:{display:false}, y:{grid:{color:'rgba(255,255,255,.08)'}}}});
    const sigList = $('#signalList');
    setInterval(()=>{
      const push = (ch) => { ch.data.datasets[0].data.push(ch.data.datasets[0].data.at(-1) + (Math.random()*2-1)); ch.data.datasets[0].data.shift(); ch.update('none'); }
      push(usT); push(volC);
      const msg = [
        'Trend uptick in Midwest mobility',
        'Volatility cooling in discretionary',
        'New claim dip vs. 4‑wk avg',
        'Pricing power holding for staples'
      ][Math.floor(Math.random()*4)];
      const li = document.createElement('li'); li.textContent = new Date().toLocaleTimeString() + ' — ' + msg; sigList.prepend(li); while(sigList.children.length>6) sigList.removeChild(sigList.lastChild);
    }, 1800);

    // ===== Data engineering =====
    $('#etl').textContent = `version: 1\n
sources:\n  - name: public_api\n    url: https://api.example.com/v1/flows\n    schedule: "0 * * * *"  # hourly\n
models:\n  - name: flows_clean\n    sql: >\n      select ts, flow, zscore(flow) over (order by ts) as z from raw_flows\n
alerts:\n  - name: flow_spike\n    when: z > 2.0\n    action: slack://#ops-analytics`;
    const pipe = $('#pipe');
    function runPipe(){
      pipe.innerHTML = '';
      const steps = [
        ['extract', 'pulling 1,000 rows from public_api', 'ok'],
        ['load', 'writing raw_flows parquet', 'ok'],
        ['transform', 'flows_clean model', 'ok'],
        ['alert', '0 spikes > 2σ', 'ok']
      ];
      steps.forEach((s,i)=> setTimeout(()=>{
        const row = document.createElement('div');
        row.innerHTML = `[${new Date().toLocaleTimeString()}] ${s[0].toUpperCase()} — ${s[1]}  [${s[2]}]`;
        pipe.appendChild(row);
      }, 600*i));
    }
    $('#runPipe').addEventListener('click', runPipe);

    // ===== Resume timeline =====
    const data = [
      {t:'2025', tag:'leadership', title:'Launched Live Intelligence Hub', body:'Shipped portfolio with live dashboards; used by stakeholders across ops & finance.', kpi:'+12 weekly active viewers'},
      {t:'2024', tag:'data-science', title:'Min–Max Inventory Optimizer', body:'Demand model with seasonal & safety stock; reduced stockouts.', kpi:'−18% stockouts'},
      {t:'2024', tag:'engineering', title:'Power BI REST automations', body:'Programmatic refresh, QoS alerts, and dataset governance.', kpi:'−8h/wk manual work'},
      {t:'2023', tag:'leadership', title:'Pricing initiative', body:'Partnered with ops to re‑price SKUs with controlled churn.', kpi:'+140 bps margin'},
    ];
    const timeline = $('#timeline');
    function renderTimeline(filter='all'){
      timeline.innerHTML='';
      data.filter(d=> filter==='all' || d.tag===filter).forEach(d=>{
        const el=document.createElement('div'); el.className='event';
        el.innerHTML = `<div class="meta">${d.t} · ${d.tag}</div><div style="font-weight:700">${d.title}</div><div>${d.body}</div><div class="chip" style="margin-top:6px">${d.kpi}</div>`;
        timeline.appendChild(el);
      });
    }
    renderTimeline();
    $$('#resume .chip[data-filter]').forEach(b=> b.addEventListener('click', ()=> renderTimeline(b.dataset.filter)));

    // ===== Resume download =====
    $('#dlResume').addEventListener('click', ()=> window.print());
  </script>
</body>
</html>

